/*
 * Automatically generated by Hostboot's ./genErrlParsers.pl
 * Do not modify this file in the FSP tree, it is provided by
 * Hostboot and will be overwritten
 *
 * TimeStamp:   Tue May 15 13:26:15 2018
 * Image Id:    hb0515b_1820.920
 *
 */

#include <errlplugins.H>
#include <errlusrparser.H>
#include <srcisrc.H>

static bool SrcDataParse(ErrlUsrParser & i_parser,
                         const SrciSrc & i_src)
{
    uint32_t l_error = (i_src.reasonCode() << 8) + i_src.moduleId();
    bool l_success = true;

    switch(l_error)
    {
    case 0x1E120F:
        i_parser.PrintString("devdesc", "Hostboot Base Image Header not valid");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_LOAD_HEADER");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_INVALID_BASE_HEADER");
        i_parser.PrintString("userdata1", "0");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1E0F0E:
        i_parser.PrintString("devdesc", "Device write did not return expected size");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_GET_ALL_SEC_REGS");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_DEVICE_WRITE_ERR");
        i_parser.PrintString("userdata1", "Actual size written");
        i_parser.PrintString("userdata2", "Expected size written");
        break;

    case 0x1E0E0D:
        i_parser.PrintString("devdesc", "Invalid SBE security mode");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_SET_SBE_SECURE_MODE");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SBE_INVALID_SEC_MODE");
        i_parser.PrintString("userdata1", "Security mode to set");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1E0709:
        i_parser.PrintString("devdesc", "Container's component ID does not match expected component ID");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_VERIFY_COMPONENT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_ROM_VERIFY");
        break;

    case 0x1E0B02:
        i_parser.PrintString("devdesc", "Valid securerom not present");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_INIT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SECROM_INVALID");
        break;

    case 0x1E0502:
        i_parser.PrintString("devdesc", "mm_set_permission(EXECUTABLE) failed for Secure ROM");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_INIT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SET_PERMISSION_FAIL_EXE");
        i_parser.PrintString("userdata1", "l_rc");
        i_parser.PrintString("userdata2", "iv_securerom");
        break;

    case 0x1E0703:
        i_parser.PrintString("devdesc", "ROM_verify() Call Failed");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_VERIFY");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_ROM_VERIFY");
        i_parser.PrintString("userdata1", "l_rc");
        i_parser.PrintString("userdata2", "l_hw_parms.log");
        break;

    case 0x1E0907:
        i_parser.PrintString("devdesc", "Invalid target used to write security register.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_WRITE_REG");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SECURE_BAD_TARGET");
        i_parser.PrintString("userdata1", "Target pointer value");
        i_parser.PrintString("userdata2", "Target's HUID or 0 if NULL target pointer");
        break;

    case 0x1E0F07:
        i_parser.PrintString("devdesc", "Device write did not return expected size");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_WRITE_REG");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_DEVICE_WRITE_ERR");
        i_parser.PrintString("userdata1", "Actual size written");
        i_parser.PrintString("userdata2", "Expected size written");
        break;

    case 0x1E0906:
        i_parser.PrintString("devdesc", "Invalid target used to read security switch register.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_READ_REG");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SECURE_BAD_TARGET");
        i_parser.PrintString("userdata1", "Target pointer value");
        i_parser.PrintString("userdata2", "Target's HUID or 0 if null target pointer.");
        break;

    case 0x1E1006:
        i_parser.PrintString("devdesc", "Processor security register read too early");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_READ_REG");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_PROC_NOT_SCOMABLE");
        i_parser.PrintString("userdata1", "Use XSCOM bool");
        i_parser.PrintString("userdata2", "Target's HUID");
        break;

    case 0x1E1106:
        i_parser.PrintString("devdesc", "Processor security register read too early");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_READ_REG");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_DEVICE_READ_ERR");
        i_parser.PrintString("userdata1", "Actual size read");
        i_parser.PrintString("userdata2", "Expected size read");
        break;

    case 0x1E0D0C:
        i_parser.PrintString("devdesc", "Error parsing secure header");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_CONT_VALIDATE");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_CONT_HDR_INVALID");
        i_parser.PrintString("userdata1[0::31]", "Magic Number");
        i_parser.PrintString("userdata1[32::63]", "ROM version");
        i_parser.PrintString("userdata2[0:15]", "Algorithm version");
        i_parser.PrintString("userdata2[16:31]", "Hash algorithm");
        i_parser.PrintString("userdata2[32:47]", "Signature algorithm");
        i_parser.PrintString("userdata2[48:63]", "SW key count");
        break;

    case 0x1E1310:
        i_parser.PrintString("devdesc", "Error parsing secure header; ECID count field of specified type was non-zero.  Reinstall boot firmware.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_VALIDATE_ECID_COUNT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_INVALID_ECID_COUNT");
        i_parser.PrintString("userdata1", "ECID count field type");
        i_parser.PrintString("userdata2", "Actual ECID count");
        break;

    case 0x1E0C0B:
        i_parser.PrintString("devdesc", "Error parsing secure header; requested copy size starting at current offset would exceed the header size or the max transaction size.  Reinstall boot firmware.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_CONT_HDR_CPY_INC");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_CONT_HDR_NO_SPACE");
        i_parser.PrintString("userdata1[00:31]", "Total bytes read so far");
        i_parser.PrintString("userdata1[32:63]", "Requested size to copy");
        i_parser.PrintString("userdata2[00:31]", "Max header size");
        i_parser.PrintString("userdata2[32:63]", "Max transaction size");
        break;

    case 0x1E0707:
        i_parser.PrintString("devdesc", "Container component ID verification failed.");
        i_parser.PrintString("moduleid", "Bootloader::MOD_BOOTLOADER_VERIFY_COMP_ID");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_ROM_VERIFY");
        i_parser.PrintString("userdata1[0:15]", "TI_WITH_SRC");
        i_parser.PrintString("userdata1[16:31]", "TI_BOOTLOADER");
        i_parser.PrintString("userdata1[32:63]", "Failing address = 0");
        i_parser.PrintString("userdata2[0:31]", "First 4 bytes of observed component ID");
        i_parser.PrintString("userdata2[32:63]", "Last 4 bytes of observed component ID");
        break;

    case 0x1E0B05:
        i_parser.PrintString("devdesc", "Valid securerom not present");
        i_parser.PrintString("moduleid", "Bootloader::MOD_BOOTLOADER_VERIFY");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SECROM_INVALID");
        i_parser.PrintString("userdata1[0:15]", "TI_WITH_SRC");
        i_parser.PrintString("userdata1[16:31]", "TI_BOOTLOADER");
        i_parser.PrintString("userdata1[32:63]", "Failing address = 0");
        break;

    case 0x1E0705:
        i_parser.PrintString("devdesc", "ROM verification failed");
        i_parser.PrintString("moduleid", "Bootloader::MOD_BOOTLOADER_VERIFY");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_ROM_VERIFY");
        i_parser.PrintString("userdata1[0:15]", "TI_WITH_SRC");
        i_parser.PrintString("userdata1[16:31]", "TI_BOOTLOADER");
        i_parser.PrintString("userdata1[32:63]", "Failing address = 0");
        i_parser.PrintString("userdata2[0:31]", "First 4 bytes System's HW keys' Hash");
        i_parser.PrintString("userdata2[32:63]", "First 4 bytes of Container Header");
        break;

    default:
        l_success = false;
        break;
    };
    return l_success;
}

static errl::SrcPlugin g_SrcPlugin(0x1E00, SrcDataParse, ERRL_CID_HOSTBOOT);
