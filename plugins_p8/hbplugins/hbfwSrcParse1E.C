/*
 * Automatically generated by Hostboot's ./genErrlParsers.pl
 * Do not modify this file in the FSP tree, it is provided by
 * Hostboot and will be overwritten
 *
 * TimeStamp:   Thu Apr 12 08:28:51 2018
 * Image Id:    hb0412a_1815.861
 *
 */

#include <errlplugins.H>
#include <errlusrparser.H>
#include <srcisrc.H>

static bool SrcDataParse(ErrlUsrParser & i_parser,
                         const SrciSrc & i_src)
{
    uint32_t l_error = (i_src.reasonCode() << 8) + i_src.moduleId();
    bool l_success = true;

    switch(l_error)
    {
    case 0x1EAC10:
        i_parser.PrintString("devdesc", "TPM log buffer init failure.");
        i_parser.PrintString("moduleid", "MOD_TPMLOGMGR_INITIALIZE");
        i_parser.PrintString("reasoncode", "RC_TPMLOGMGR_INIT_FAIL");
        i_parser.PrintString("userdata1", "0");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EB0012:
        i_parser.PrintString("devdesc", "TPM log header entry is missing.");
        i_parser.PrintString("moduleid", "MOD_TPMLOGMGR_INITIALIZEEXISTLOG");
        i_parser.PrintString("reasoncode", "RC_TPMLOGMGR_LOGWALKFAIL");
        i_parser.PrintString("userdata1", "0");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EAA11:
        i_parser.PrintString("devdesc", "TPM log buffer add failure.");
        i_parser.PrintString("moduleid", "MOD_TPMLOGMGR_ADDEVENT");
        i_parser.PrintString("reasoncode", "RC_TPMLOGMGR_ADDEVENT_FAIL");
        i_parser.PrintString("userdata1[0:31]", "Max log size");
        i_parser.PrintString("userdata1[32:63]", "Log buffer NULL");
        i_parser.PrintString("userdata2[0:31]", "Current Log Size");
        i_parser.PrintString("userdata2[32:63]", "New entry size");
        break;

    case 0x1EAB11:
        i_parser.PrintString("devdesc", "log buffer marshal failure.");
        i_parser.PrintString("moduleid", "MOD_TPMLOGMGR_ADDEVENT");
        i_parser.PrintString("reasoncode", "RC_TPMLOGMGR_ADDEVENTMARSH_FAIL");
        i_parser.PrintString("userdata1", "0");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA604:
        i_parser.PrintString("devdesc", "Unsupported command code during marshal");
        i_parser.PrintString("moduleid", "MOD_TPM_MARSHALCMDDATA");
        i_parser.PrintString("reasoncode", "RC_TPM_MARSHAL_INVALID_CMD");
        i_parser.PrintString("userdata1", "Command Code");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA704:
        i_parser.PrintString("devdesc", "Marshaling error detected");
        i_parser.PrintString("moduleid", "MOD_TPM_MARSHALCMDDATA");
        i_parser.PrintString("reasoncode", "RC_TPM_MARSHALING_FAIL");
        i_parser.PrintString("userdata1", "stage");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA805:
        i_parser.PrintString("devdesc", "Unsupported command code during unmarshal");
        i_parser.PrintString("moduleid", "MOD_TPM_UNMARSHALRESPDATA");
        i_parser.PrintString("reasoncode", "RC_TPM_UNMARSHAL_INVALID_CMD");
        i_parser.PrintString("userdata1", "commandcode");
        i_parser.PrintString("userdata2", "stage");
        break;

    case 0x1EA905:
        i_parser.PrintString("devdesc", "Unmarshaling error detected");
        i_parser.PrintString("moduleid", "MOD_TPM_UNMARSHALRESPDATA");
        i_parser.PrintString("reasoncode", "RC_TPM_UNMARSHALING_FAIL");
        i_parser.PrintString("userdata1", "Stage");
        i_parser.PrintString("userdata2", "Remaining response buffer size");
        break;

    case 0x1EA002:
        i_parser.PrintString("devdesc", "Invalid operation type.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_STARTUP");
        i_parser.PrintString("reasoncode", "RC_TPM_START_FAIL");
        i_parser.PrintString("userdata1", "responseCode");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA203:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_GETCAPFWVERSION");
        i_parser.PrintString("reasoncode", "RC_TPM_GETCAP_FAIL");
        i_parser.PrintString("userdata1", "responseCode");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA303:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_GETCAPFWVERSION");
        i_parser.PrintString("reasoncode", "RC_TPM_GETCAP_FW_INVALID_RESP");
        i_parser.PrintString("userdata1", "capability");
        i_parser.PrintString("userdata2", "property");
        break;

    case 0x1EA403:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_GETCAPFWVERSION");
        i_parser.PrintString("reasoncode", "RC_TPM_GETCAP2_FAIL");
        i_parser.PrintString("userdata1", "responseCode");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EA503:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_GETCAPFWVERSION");
        i_parser.PrintString("reasoncode", "RC_TPM_GETCAP2_FW_INVALID_RESP");
        i_parser.PrintString("userdata1", "capability");
        i_parser.PrintString("userdata2", "property");
        break;

    case 0x1EAF07:
        i_parser.PrintString("devdesc", "Unmarshaling error detected");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_PCREXTEND");
        i_parser.PrintString("reasoncode", "RC_TPM_INVALID_ARGS");
        i_parser.PrintString("userdata1", "Digest Ptr");
        i_parser.PrintString("userdata2[0:15]", "Full Digest Size 1");
        i_parser.PrintString("userdata2[16:31]", "Full Digest Size 2");
        i_parser.PrintString("userdata2[32:63]", "PCR");
        break;

    case 0x1EAE07:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_PCREXTEND");
        i_parser.PrintString("reasoncode", "RC_TPM_COMMAND_FAIL");
        i_parser.PrintString("userdata1", "responseCode");
        i_parser.PrintString("userdata2", "dataSize");
        break;

    case 0x1EAF08:
        i_parser.PrintString("devdesc", "Unmarshaling error detected");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_PCRREAD");
        i_parser.PrintString("reasoncode", "RC_TPM_INVALID_ARGS");
        i_parser.PrintString("userdata1", "Digest Ptr");
        i_parser.PrintString("userdata2[0:31]", "Full Digest Size");
        i_parser.PrintString("userdata2[32:63]", "PCR");
        break;

    case 0x1EAE08:
        i_parser.PrintString("devdesc", "Command failure reading TPM FW version.");
        i_parser.PrintString("moduleid", "MOD_TPM_CMD_PCRREAD");
        i_parser.PrintString("reasoncode", "RC_TPM_COMMAND_FAIL");
        i_parser.PrintString("userdata1", "responseCode");
        i_parser.PrintString("userdata2", "dataSize");
        break;

    case 0x1EA909:
        i_parser.PrintString("devdesc", "Unmarshal error while replaying tpm log.");
        i_parser.PrintString("moduleid", "MOD_TPM_REPLAY_LOG");
        i_parser.PrintString("reasoncode", "RC_TPM_UNMARSHALING_FAIL");
        i_parser.PrintString("userdata1", "Starting address of event that caused error");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EAD06:
        i_parser.PrintString("devdesc", "No functional TPMs exist in the system");
        i_parser.PrintString("moduleid", "MOD_TPM_VERIFYFUNCTIONAL");
        i_parser.PrintString("reasoncode", "RC_TPM_NOFUNCTIONALTPM_FAIL");
        i_parser.PrintString("userdata1", "0");
        i_parser.PrintString("userdata2", "0");
        break;

    case 0x1EB30B:
        i_parser.PrintString("devdesc", "msg_respond() failed");
        i_parser.PrintString("moduleid", "MOD_TPM_TPMDAEMON");
        i_parser.PrintString("reasoncode", "RC_MSGRESPOND_FAIL");
        i_parser.PrintString("userdata1", "rc from msq_respond()");
        break;

    case 0x1EB10A:
        i_parser.PrintString("devdesc", "msg_sendrecv() failed");
        i_parser.PrintString("moduleid", "MOD_TPM_PCREXTEND");
        i_parser.PrintString("reasoncode", "RC_PCREXTEND_SENDRECV_FAIL");
        i_parser.PrintString("userdata1", "rc from msq_sendrecv()");
        break;

    case 0x1EB20A:
        i_parser.PrintString("devdesc", "msg_send() failed");
        i_parser.PrintString("moduleid", "MOD_TPM_PCREXTEND");
        i_parser.PrintString("reasoncode", "RC_PCREXTEND_SEND_FAIL");
        i_parser.PrintString("userdata1", "rc from msq_send()");
        break;

    case 0x1EB30C:
        i_parser.PrintString("devdesc", "msg_respond() failed");
        i_parser.PrintString("moduleid", "MOD_TPM_SYNCRESPONSE");
        i_parser.PrintString("reasoncode", "RC_MSGRESPOND_FAIL");
        i_parser.PrintString("userdata1", "rc from msq_respond()");
        break;

    case 0x1E0101:
        i_parser.PrintString("devdesc", "Attempted to purge cache while purge operation was pending.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_BLINDPURGE");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_PURGEOP_PENDING");
        i_parser.PrintString("userdata1", "SCOM value.");
        i_parser.PrintString("userdata2", "CPU ID (PIR) encountering failure.");
        break;

    case 0x1E0201:
        i_parser.PrintString("devdesc", "Purge operation never completed.");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_BLINDPURGE");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_PURGEOP_FAIL_COMPLETE");
        i_parser.PrintString("userdata1", "SCOM value of Reg 0x1001080E");
        break;

    case 0x1E0302:
        i_parser.PrintString("devdesc", "mmio_dev_map() failed for Secure ROM");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_INIT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_DEV_MAP_FAIL");
        i_parser.PrintString("userdata1", "TBROM Register Address");
        i_parser.PrintString("userdata2", "TBROM Register Data");
        break;

    case 0x1E0502:
        i_parser.PrintString("devdesc", "mm_set_permission(EXECUTABLE) failed for Secure ROM");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_INIT");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SET_PERMISSION_FAIL_EXE");
        i_parser.PrintString("userdata1", "l_rc");
        i_parser.PrintString("userdata2", "iv_device_ptr");
        break;

    case 0x1E0703:
        i_parser.PrintString("devdesc", "ROM_verify() Call Failed");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_VERIFY");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_ROM_VERIFY");
        i_parser.PrintString("userdata1", "l_rc");
        i_parser.PrintString("userdata2", "l_hw_parms.log");
        break;

    case 0x1E0604:
        i_parser.PrintString("devdesc", "mm_set_permission(WRITABLE) failed for Secure ROM");
        i_parser.PrintString("moduleid", "SECUREBOOT::MOD_SECURE_ROM_CLEANUP");
        i_parser.PrintString("reasoncode", "SECUREBOOT::RC_SET_PERMISSION_FAIL_WRITE");
        i_parser.PrintString("userdata1", "l_rc");
        i_parser.PrintString("userdata2", "iv_device_ptr");
        break;

    default:
        l_success = false;
        break;
    };
    return l_success;
}

static errl::SrcPlugin g_SrcPlugin(0x1E00, SrcDataParse, ERRL_CID_HOSTBOOT);
